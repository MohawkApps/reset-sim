#!/usr/bin/env ruby

def osascript(script)
  system 'osascript', *script.split(/\n/).map { |line| ['-e', line] }.flatten
end

osascript <<-END
    if application "iOS Simulator" is running then
        set simulator_app_name to "iOS Simulator"
    else if application "Simulator" is running then
        set simulator_app_name to "Simulator"
    else
        log "Simulator must be running before it can be reset."
        return
    end if

    tell application simulator_app_name
        activate
    end tell

    tell application "System Events"
        tell process simulator_app_name
            tell menu bar 1
                tell menu bar item simulator_app_name
                    tell menu simulator_app_name
                        click menu item "Reset Content and Settingsâ€¦"
                    end tell
                end tell
            end tell
            tell window 1
                click button "Reset"
            end tell
        end tell
    end tell
END
